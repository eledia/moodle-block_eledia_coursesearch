{"version":3,"file":"view.min.js","sources":["../src/view.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle. If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Manage the courses view for the overview block.\n *\n * @copyright  2018 Bas Brands <bas@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n//import $, { error } from 'jquery';\nimport $ from 'jquery';\nimport * as Repository from 'block_eledia_telc_coursesearch/repository';\nimport * as PagedContentFactory from 'core/paged_content_factory';\nimport * as PubSub from 'core/pubsub';\nimport * as CustomEvents from 'core/custom_interaction_events';\nimport * as Notification from 'core/notification';\nimport { exception as displayException } from 'core/notification';\nimport * as Templates from 'core/templates';\nimport * as CourseEvents from 'core_course/events';\nimport SELECTORS from 'block_eledia_telc_coursesearch/selectors';\nimport * as PagedContentEvents from 'core/paged_content_events';\nimport * as Aria from 'core/aria';\nimport { debounce } from 'core/utils';\nimport { setUserPreference } from 'core_user/repository';\n\nconst TEMPLATES = {\n    COURSES_CARDS: 'block_eledia_telc_coursesearch/view-cards',\n    COURSES_LIST: 'block_eledia_telc_coursesearch/view-list',\n    COURSES_SUMMARY: 'block_eledia_telc_coursesearch/view-summary',\n    NOCOURSES: 'core_course/no-courses'\n};\n\nconst GROUPINGS = {\n    GROUPING_ALLINCLUDINGHIDDEN: 'allincludinghidden',\n    GROUPING_ALL: 'all',\n    GROUPING_INPROGRESS: 'inprogress',\n    GROUPING_FUTURE: 'future',\n    GROUPING_PAST: 'past',\n    GROUPING_FAVOURITES: 'favourites',\n    GROUPING_HIDDEN: 'hidden'\n};\n\nconst NUMCOURSES_PERPAGE = [12, 24, 48, 96, 0];\n\nlet loadedPages = [];\n\nlet courseOffset = 0;\n\nlet lastPage = 0;\n\nlet lastLimit = 0;\n\nlet namespace = null;\n\nlet catInit = false;\n\nlet selectedCategories = [];\nlet selectableCategories = [];\n/**\n * Structure of elements:\n * {\n *     3: [\n *         {\n *             id: 20,\n *             name: 'name',\n *             value: 'value,\n *             displayValue: 'Display Value',\n *         },\n *     ],\n * }\n */\nlet customfields = [];\nlet selectedCustomfields = [];\nlet searchTerm = '';\n\n/**\n * Whether the summary display has been loaded.\n *\n * If true, this means that courses have been loaded with the summary text.\n * Otherwise, switching to the summary display mode will require course data to be fetched with the summary text.\n *\n * @type {boolean}\n */\nlet summaryDisplayLoaded = false;\n\n/**\n * Get filter values from DOM.\n *\n * @param {object} root The root element for the courses view.\n * @return {filters} Set filters.\n */\nconst getFilterValues = root => {\n    const courseRegion = root.find(SELECTORS.courseView.region);\n    return {\n        display: courseRegion.attr('data-display'),\n        grouping: courseRegion.attr('data-grouping'),\n        sort: courseRegion.attr('data-sort'),\n        displaycategories: courseRegion.attr('data-displaycategories'),\n        // TODO: Remove\n        customfieldname: courseRegion.attr('data-customfieldname'),\n        customfieldvalue: courseRegion.attr('data-customfieldvalue'),\n    };\n};\n\n/**\n * Get filter values from DOM and global variables.\n *\n * @param {object} root The root element for the courses view.\n * @return {filters} Set filters.\n */\nconst getAllFilterValues = root => {\n    const courseRegion = root.find(SELECTORS.courseView.region);\n    return {\n        display: courseRegion.attr('data-display'),\n        grouping: courseRegion.attr('data-grouping'),\n        sort: courseRegion.attr('data-sort'),\n        displaycategories: courseRegion.attr('data-displaycategories'),\n        customfields: customfields,\n        selectedCategories: selectedCategories,\n    };\n};\n\n// We want the paged content controls below the paged content area.\n// and the controls should be ignored while data is loading.\nconst DEFAULT_PAGED_CONTENT_CONFIG = {\n    ignoreControlWhileLoading: true,\n    controlPlacementBottom: true,\n    persistentLimitKey: 'block_eledia_telc_coursesearch_user_paging_preference'\n};\n\n/**\n * Get enrolled courses from backend.\n *\n * @param {object} filters The filters for this view.\n * @param {int} limit The number of courses to show.\n * @param {object} searchParams The params.\n * @return {promise} Resolved with an array of courses.\n */\nconst getMyCourses = (filters, limit, searchParams) => {\n    // TODO: More Params\n    const params = {\n        offset: courseOffset,\n        limit: limit,\n        classification: filters.grouping,\n        sort: filters.sort,\n        customfieldname: filters.customfieldname,\n        customfieldvalue: filters.customfieldvalue,\n    };\n    if (filters.display === 'summary') {\n        params.requiredfields = Repository.SUMMARY_REQUIRED_FIELDS;\n        summaryDisplayLoaded = true;\n    } else {\n        params.requiredfields = Repository.CARDLIST_REQUIRED_FIELDS;\n    }\n    // return Repository.getEnrolledCoursesByTimeline(searchParams);\n    return Repository.getEnrolledCoursesByTimeline(searchParams);\n};\n\n/**\n * Search for enrolled courses from backend.\n *\n * @param {object} filters The filters for this view.\n * @param {int} limit The number of courses to show.\n * @param {string} searchValue What does the user want to search within their courses.\n * @return {promise} Resolved with an array of courses.\n */\nconst getSearchMyCourses = (filters, limit, searchValue) => {\n    const params = {\n        offset: courseOffset,\n        limit: limit,\n        classification: 'search',\n        sort: filters.sort,\n        customfieldname: filters.customfieldname,\n        customfieldvalue: filters.customfieldvalue,\n        searchvalue: searchValue,\n    };\n    if (filters.display === 'summary') {\n        params.requiredfields = Repository.SUMMARY_REQUIRED_FIELDS;\n        summaryDisplayLoaded = true;\n    } else {\n        params.requiredfields = Repository.CARDLIST_REQUIRED_FIELDS;\n        summaryDisplayLoaded = false;\n    }\n    // return Repository.getEnrolledCoursesByTimeline(params);\n    return Repository.getEnrolledCoursesByTimeline(searchValue);\n};\n\n/**\n * Search for categories from backend.\n *\n * @param {string} key filters The filters for this view.\n * @param {string} searchValue What does the user want to search within the categoies names.\n * @param {boolean} subCategories search for sub categories\n * @param {object} categories\n * @param {object} selectedCategories\n * @param {object} customfields\n * @param {object} selectedCustomfields\n * @return {promise} Resolved with an array of categories.\n */\nconst getSearchCategories = (key,\n    searchValue,\n    subCategories,\n    categories,\n    selectedCategories,\n    customfields,\n    selectedCustomfields) => {\n    window.console.log(key);\n    window.console.log(searchValue);\n    window.console.log(selectedCategories);\n    categories = [];\n    selectedCategories = [];\n    const params = {\n        // NOTE: It might be beneficial to allow multiple criteria of the core supported ones.\n        criteria: [\n            {\n                key: key,\n                value: searchValue,\n            },\n            {\n                key: 'categories',\n                customfields: categories,\n            },\n            {\n                key: 'selectedCategories',\n                customfields: selectedCategories,\n            },\n            {\n                key: 'customfields',\n                customfields: customfields,\n            },\n            {\n                key: 'selectedCustomfields',\n                customfields: selectedCustomfields,\n            },\n        ],\n        //addsubcategories: subCategories,\n        //criteria: [\n        //],\n        addsubcategories: subCategories,\n    };\n    return Repository.getCategories(params);\n};\n\n/**\n * Get params for search\n *\n * @param {int} limit\n *\n * @return {Object} The favourite icon container\n */\nconst getParams = (limit = 0) => {\n    const params = {\n        criteria: [\n            {\n                key: 'name',\n                value: searchTerm,\n            },\n            {\n                key: 'selectedCategories',\n                categories: selectedCategories,\n            },\n            {\n                key: 'selectedCustomfields',\n                customfields: selectedCustomfields,\n            },\n            {\n                key: 'limit',\n                value: limit,\n            },\n            {\n                key: 'offset',\n                value: courseOffset,\n            },\n        ],\n        addsubcategories: true,\n    };\n    return params;\n};\n\n/**\n * Get the container element for the favourite icon.\n *\n * @param {Object} root The course overview container\n * @param {Number} courseId Course id number\n * @return {Object} The favourite icon container\n */\nconst getFavouriteIconContainer = (root, courseId) => {\n    return root.find(SELECTORS.FAVOURITE_ICON + '[data-course-id=\"' + courseId + '\"]');\n};\n\n/**\n * Get the paged content container element.\n *\n * @param {Object} root The course overview container\n * @param {Number} index Rendered page index.\n * @return {Object} The rendered paged container.\n */\nconst getPagedContentContainer = (root, index) => {\n    return root.find('[data-region=\"paged-content-page\"][data-page=\"' + index + '\"]');\n};\n\n/**\n * Get the course id from a favourite element.\n *\n * @param {Object} root The favourite icon container element.\n * @return {Number} Course id.\n */\nconst getCourseId = root => {\n    return root.attr('data-course-id');\n};\n\n/**\n * Hide the favourite icon.\n *\n * @param {Object} root The favourite icon container element.\n * @param {Number} courseId Course id number.\n */\nconst hideFavouriteIcon = (root, courseId) => {\n    const iconContainer = getFavouriteIconContainer(root, courseId);\n\n    const isFavouriteIcon = iconContainer.find(SELECTORS.ICON_IS_FAVOURITE);\n    isFavouriteIcon.addClass('hidden');\n    Aria.hide(isFavouriteIcon);\n\n    const notFavourteIcon = iconContainer.find(SELECTORS.ICON_NOT_FAVOURITE);\n    notFavourteIcon.removeClass('hidden');\n    Aria.unhide(notFavourteIcon);\n};\n\n/**\n * Show the favourite icon.\n *\n * @param {Object} root The course overview container.\n * @param {Number} courseId Course id number.\n */\nconst showFavouriteIcon = (root, courseId) => {\n    const iconContainer = getFavouriteIconContainer(root, courseId);\n\n    const isFavouriteIcon = iconContainer.find(SELECTORS.ICON_IS_FAVOURITE);\n    isFavouriteIcon.removeClass('hidden');\n    Aria.unhide(isFavouriteIcon);\n\n    const notFavourteIcon = iconContainer.find(SELECTORS.ICON_NOT_FAVOURITE);\n    notFavourteIcon.addClass('hidden');\n    Aria.hide(notFavourteIcon);\n};\n\n/**\n * Get the action menu item\n *\n * @param {Object} root The course overview container\n * @param {Number} courseId Course id.\n * @return {Object} The add to favourite menu item.\n */\nconst getAddFavouriteMenuItem = (root, courseId) => {\n    return root.find('[data-action=\"add-favourite\"][data-course-id=\"' + courseId + '\"]');\n};\n\n/**\n * Get the action menu item\n *\n * @param {Object} root The course overview container\n * @param {Number} courseId Course id.\n * @return {Object} The remove from favourites menu item.\n */\nconst getRemoveFavouriteMenuItem = (root, courseId) => {\n    return root.find('[data-action=\"remove-favourite\"][data-course-id=\"' + courseId + '\"]');\n};\n\n/**\n * Add course to favourites\n *\n * @param {Object} root The course overview container\n * @param {Number} courseId Course id number\n */\nconst addToFavourites = (root, courseId) => {\n    const removeAction = getRemoveFavouriteMenuItem(root, courseId);\n    const addAction = getAddFavouriteMenuItem(root, courseId);\n\n    setCourseFavouriteState(courseId, true).then(success => {\n        if (success) {\n            PubSub.publish(CourseEvents.favourited, courseId);\n            removeAction.removeClass('hidden');\n            addAction.addClass('hidden');\n            showFavouriteIcon(root, courseId);\n        } else {\n            Notification.alert('Starring course failed', 'Could not change favourite state');\n        }\n        return;\n    }).catch(Notification.exception);\n};\n\n/**\n * Remove course from favourites\n *\n * @param {Object} root The course overview container\n * @param {Number} courseId Course id number\n */\nconst removeFromFavourites = (root, courseId) => {\n    const removeAction = getRemoveFavouriteMenuItem(root, courseId);\n    const addAction = getAddFavouriteMenuItem(root, courseId);\n\n    setCourseFavouriteState(courseId, false).then(success => {\n        if (success) {\n            PubSub.publish(CourseEvents.unfavorited, courseId);\n            removeAction.addClass('hidden');\n            addAction.removeClass('hidden');\n            hideFavouriteIcon(root, courseId);\n        } else {\n            Notification.alert('Starring course failed', 'Could not change favourite state');\n        }\n        return;\n    }).catch(Notification.exception);\n};\n\n/**\n * Get the action menu item\n *\n * @param {Object} root The course overview container\n * @param {Number} courseId Course id.\n * @return {Object} The hide course menu item.\n */\nconst getHideCourseMenuItem = (root, courseId) => {\n    return root.find('[data-action=\"hide-course\"][data-course-id=\"' + courseId + '\"]');\n};\n\n/**\n * Get the action menu item\n *\n * @param {Object} root The course overview container\n * @param {Number} courseId Course id.\n * @return {Object} The show course menu item.\n */\nconst getShowCourseMenuItem = (root, courseId) => {\n    return root.find('[data-action=\"show-course\"][data-course-id=\"' + courseId + '\"]');\n};\n\n/**\n * Hide course\n *\n * @param {Object} root The course overview container\n * @param {Number} courseId Course id number\n */\nconst hideCourse = (root, courseId) => {\n    const hideAction = getHideCourseMenuItem(root, courseId);\n    const showAction = getShowCourseMenuItem(root, courseId);\n    const filters = getFilterValues(root);\n\n    setCourseHiddenState(courseId, true);\n\n    // Remove the course from this view as it is now hidden and thus not covered by this view anymore.\n    // Do only if we are not in \"All (including archived)\" view mode where really all courses are shown.\n    if (filters.grouping !== GROUPINGS.GROUPING_ALLINCLUDINGHIDDEN) {\n        hideElement(root, courseId);\n    }\n\n    hideAction.addClass('hidden');\n    showAction.removeClass('hidden');\n};\n\n/**\n * Show course\n *\n * @param {Object} root The course overview container\n * @param {Number} courseId Course id number\n */\nconst showCourse = (root, courseId) => {\n    const hideAction = getHideCourseMenuItem(root, courseId);\n    const showAction = getShowCourseMenuItem(root, courseId);\n    const filters = getFilterValues(root);\n\n    setCourseHiddenState(courseId, null);\n\n    // Remove the course from this view as it is now shown again and thus not covered by this view anymore.\n    // Do only if we are not in \"All (including archived)\" view mode where really all courses are shown.\n    if (filters.grouping !== GROUPINGS.GROUPING_ALLINCLUDINGHIDDEN) {\n        hideElement(root, courseId);\n    }\n\n    hideAction.removeClass('hidden');\n    showAction.addClass('hidden');\n};\n\n/**\n * Set the courses hidden status and push to repository\n *\n * @param {Number} courseId Course id to favourite.\n * @param {Boolean} status new hidden status.\n * @return {Promise} Repository promise.\n */\nconst setCourseHiddenState = (courseId, status) => {\n\n    // If the given status is not hidden, the preference has to be deleted with a null value.\n    if (status === false) {\n        status = null;\n    }\n\n    return setUserPreference(`block_eledia_telc_coursesearch_hidden_course_${courseId}`, status)\n        .catch(Notification.exception);\n};\n\n/**\n * Reset the loadedPages dataset to take into account the hidden element\n *\n * @param {Object} root The course overview container\n * @param {Number} id The course id number\n */\nconst hideElement = (root, id) => {\n    const pagingBar = root.find('[data-region=\"paging-bar\"]');\n    const jumpto = parseInt(pagingBar.attr('data-active-page-number'));\n\n    // Get a reduced dataset for the current page.\n    const courseList = loadedPages[jumpto];\n    let reducedCourse = courseList.courses.reduce((accumulator, current) => {\n        if (+id !== +current.id) {\n            accumulator.push(current);\n        }\n        return accumulator;\n    }, []);\n\n    // Get the next page's data if loaded and pop the first element from it.\n    if (typeof (loadedPages[jumpto + 1]) !== 'undefined') {\n        const newElement = loadedPages[jumpto + 1].courses.slice(0, 1);\n\n        // Adjust the dataset for the reset of the pages that are loaded.\n        loadedPages.forEach((courseList, index) => {\n            if (index > jumpto) {\n                let popElement = [];\n                if (typeof (loadedPages[index + 1]) !== 'undefined') {\n                    popElement = loadedPages[index + 1].courses.slice(0, 1);\n                }\n                loadedPages[index].courses = [...loadedPages[index].courses.slice(1), ...popElement];\n            }\n        });\n\n        reducedCourse = [...reducedCourse, ...newElement];\n    }\n\n    // Check if the next page is the last page and if it still has data associated to it.\n    if (lastPage === jumpto + 1 && loadedPages[jumpto + 1].courses.length === 0) {\n        const pagedContentContainer = root.find('[data-region=\"paged-content-container\"]');\n        PagedContentFactory.resetLastPageNumber($(pagedContentContainer).attr('id'), jumpto);\n    }\n\n    loadedPages[jumpto].courses = reducedCourse;\n\n    // Reduce the course offset.\n    courseOffset--;\n\n    // Render the paged content for the current.\n    const pagedContentPage = getPagedContentContainer(root, jumpto);\n    renderCourses(root, loadedPages[jumpto]).then((html, js) => {\n        return Templates.replaceNodeContents(pagedContentPage, html, js);\n    }).catch(Notification.exception);\n\n    // Delete subsequent pages in order to trigger the callback.\n    loadedPages.forEach((courseList, index) => {\n        if (index > jumpto) {\n            const page = getPagedContentContainer(root, index);\n            page.remove();\n        }\n    });\n};\n\n/**\n * Set the courses favourite status and push to repository\n *\n * @param {Number} courseId Course id to favourite.\n * @param {boolean} status new favourite status.\n * @return {Promise} Repository promise.\n */\nconst setCourseFavouriteState = (courseId, status) => {\n\n    return Repository.setFavouriteCourses({\n        courses: [\n            {\n                'id': courseId,\n                'favourite': status\n            }\n        ]\n    }).then(result => {\n        if (result.warnings.length === 0) {\n            loadedPages.forEach(courseList => {\n                courseList.courses.forEach((course, index) => {\n                    if (course.id == courseId) {\n                        courseList.courses[index].isfavourite = status;\n                    }\n                });\n            });\n            return true;\n        } else {\n            return false;\n        }\n    }).catch(Notification.exception);\n};\n\n/**\n * Given there are no courses to render provide the rendered template.\n *\n * @param {object} root The root element for the courses view.\n * @return {promise} jQuery promise resolved after rendering is complete.\n */\nconst noCoursesRender = root => {\n    const nocoursesimg = root.find(SELECTORS.courseView.region).attr('data-nocoursesimg');\n    const newcourseurl = root.find(SELECTORS.courseView.region).attr('data-newcourseurl');\n    return Templates.render(TEMPLATES.NOCOURSES, {\n        nocoursesimg: nocoursesimg,\n        newcourseurl: newcourseurl\n    });\n};\n\n/**\n * Render the dashboard courses.\n *\n * @param {object} root The root element for the courses view.\n * @param {array} coursesData containing array of returned courses.\n * @return {promise} jQuery promise resolved after rendering is complete.\n */\nconst renderCourses = (root, coursesData) => {\n\n    const filters = getFilterValues(root);\n\n    let currentTemplate = '';\n    if (filters.display === 'card') {\n        currentTemplate = TEMPLATES.COURSES_CARDS;\n    } else if (filters.display === 'list') {\n        currentTemplate = TEMPLATES.COURSES_LIST;\n    } else {\n        currentTemplate = TEMPLATES.COURSES_SUMMARY;\n    }\n\n    if (!coursesData) {\n        return noCoursesRender(root);\n    } else {\n        // Sometimes we get weird objects coming after a failed search, cast to ensure typing functions.\n        if (Array.isArray(coursesData.courses) === false) {\n            coursesData.courses = Object.values(coursesData.courses);\n        }\n        // Whether the course category should be displayed in the course item.\n        coursesData.courses = coursesData.courses.map(course => {\n            course.showcoursecategory = filters.displaycategories === 'on';\n            return course;\n        });\n        if (coursesData.courses.length) {\n            return Templates.render(currentTemplate, {\n                courses: coursesData.courses,\n            });\n        } else {\n            return noCoursesRender(root);\n        }\n    }\n};\n\n/**\n * Render the categories in search dropdown.\n *\n * @param {string} dropdownContainer The categories element for the courses view.\n * @param {string} dropdown The categories element for the courses view.\n * @param {array} categoriesData containing array of returned categories.\n * @param {array} selectionsData containing array of selected categories.\n * @param {object} page The page object.\n * @return {promise} jQuery promise resolved after rendering is complete.\n */\nconst renderCategories = (dropdownContainer, dropdown, categoriesData, selectionsData, page) => { // eslint-disable-line\n\n    // const filters = getFilterValues(categories);\n\n    const template = 'block_eledia_telc_coursesearch/nav-category-dropdown';\n\n    // TODO: Render template with data. Mustache template should be able to make the data work by itself.\n    // Sometimes we get weird objects coming after a failed search, cast to ensure typing functions.\n    //if (Array.isArray(categoriesData.data) === false) {\n    //        categoriesData.data = Object.values(categoriesData.data);\n    //}\n    // Whether the course category should be displayed in the course item.\n    // if (categoriesData.data.length) {\n    // NOTE: Render function for mustache.\n    window.console.log('render categoriesData');\n    return Templates.renderForPromise(template, {\n        categories: categoriesData,\n        catselections: selectionsData,\n    }).then(({ html, js }) => {\n        window.console.log('replaceNodeContents');\n        window.console.log(html);\n        window.console.log(js);\n        const renderResult = Templates.replaceNodeContents(dropdownContainer, html, js);\n        const catDropdown = page.querySelector(dropdown);\n        catDropdown.style.display = 'block';\n        return renderResult;\n    }).catch(error => displayException(error));\n};\n\n/**\n * Return the callback to be passed to the subscribe event\n *\n * @param {object} root The root element for the courses view\n * @return {function} Partially applied function that'll execute when passed a limit\n */\nconst setLimit = root => {\n    // @param {Number} limit The paged limit that is passed through the event.\n    return limit => root.find(SELECTORS.courseView.region).attr('data-paging', limit);\n};\n\n/**\n * Intialise the paged list and cards views on page load.\n * Returns an array of paged contents that we would like to handle here\n *\n * @param {object} root The root element for the courses view\n * @param {string} namespace The namespace for all the events attached\n */\nconst registerPagedEventHandlers = (root, namespace) => {\n    const event = namespace + PagedContentEvents.SET_ITEMS_PER_PAGE_LIMIT;\n    PubSub.subscribe(event, setLimit(root));\n};\n\n/**\n * Figure out how many items are going to be allowed to be rendered in the block.\n *\n * @param  {Number} pagingLimit How many courses to display\n * @param  {Object} root The course overview container\n * @return {Number[]} How many courses will be rendered\n */\nconst itemsPerPageFunc = (pagingLimit, root) => {\n    let itemsPerPage = NUMCOURSES_PERPAGE.map(value => {\n        let active = false;\n        if (value === pagingLimit) {\n            active = true;\n        }\n\n        return {\n            value: value,\n            active: active\n        };\n    });\n\n    // Filter out all pagination options which are too large for the amount of courses user is enrolled in.\n    const totalCourseCount = parseInt(root.find(SELECTORS.courseView.region).attr('data-totalcoursecount'), 10);\n    return itemsPerPage.filter(pagingOption => {\n        if (pagingOption.value === 0 && totalCourseCount > 100) {\n            // To minimise performance issues, do not show the \"All\" option\n            // if the user is enrolled in more than 100 courses.\n            return false;\n        }\n        return pagingOption.value < totalCourseCount;\n    });\n};\n\n/**\n * Mutates and controls the loadedPages array and handles the bootstrapping.\n *\n * @param {Array|Object} coursesData Array of all of the courses to start building the page from\n * @param {Number} currentPage What page are we currently on?\n * @param {Object} pageData Any current page information\n * @param {Object} actions Paged content helper\n * @param {null|boolean} activeSearch Are we currently actively searching and building up search results?\n */\nconst pageBuilder = (coursesData, currentPage, pageData, actions, activeSearch = null) => {\n    // TODO: Include populating category search and custom fields.\n    // If the courseData comes in an object then get the value otherwise it is a pure array.\n    let courses = coursesData.courses ? coursesData.courses : coursesData;\n    let nextPageStart = 0;\n    let pageCourses = [];\n\n    // If current page's data is loaded make sure we max it to page limit.\n    if (typeof (loadedPages[currentPage]) !== 'undefined') {\n        pageCourses = loadedPages[currentPage].courses;\n        const currentPageLength = pageCourses.length;\n        if (currentPageLength < pageData.limit) {\n            nextPageStart = pageData.limit - currentPageLength;\n            pageCourses = { ...loadedPages[currentPage].courses, ...courses.slice(0, nextPageStart) };\n        }\n    } else {\n        // When the page limit is zero, there is only one page of courses, no start for next page.\n        nextPageStart = pageData.limit || false;\n        pageCourses = (pageData.limit > 0) ? courses.slice(0, pageData.limit) : courses;\n    }\n\n    // Finished setting up the current page.\n    loadedPages[currentPage] = {\n        courses: pageCourses\n    };\n\n    // Set up the next page (if there is more than one page).\n    const remainingCourses = nextPageStart !== false ? courses.slice(nextPageStart, courses.length) : [];\n    if (remainingCourses.length) {\n        loadedPages[currentPage + 1] = {\n            courses: remainingCourses\n        };\n    }\n\n    // Set the last page to either the current or next page.\n    if (loadedPages[currentPage].courses.length < pageData.limit || !remainingCourses.length) {\n        lastPage = currentPage;\n        if (activeSearch === null) {\n            actions.allItemsLoaded(currentPage);\n        }\n    } else if (typeof (loadedPages[currentPage + 1]) !== 'undefined'\n        && loadedPages[currentPage + 1].courses.length < pageData.limit) {\n        lastPage = currentPage + 1;\n    }\n\n    courseOffset = coursesData.nextoffset;\n};\n\n/**\n * In cases when switching between regular rendering and search rendering we need to reset some variables.\n */\nconst resetGlobals = () => {\n    courseOffset = 0;\n    loadedPages = [];\n    lastPage = 0;\n    lastLimit = 0;\n};\n\n/**\n * The default functionality of fetching paginated courses without special handling.\n *\n * @return {function(Object, Object, Object, Object, Object, Promise, Number, Object): void}\n */\nconst standardFunctionalityCurry = () => {\n    resetGlobals();\n    return (filters, currentPage, pageData, actions, root, promises, limit, searchParams) => {\n        const pagePromise = getMyCourses(\n            filters,\n            limit,\n            searchParams\n        ).then(coursesData => {\n            pageBuilder(coursesData, currentPage, pageData, actions);\n            return renderCourses(root, loadedPages[currentPage]);\n        }).catch(Notification.exception);\n\n        promises.push(pagePromise);\n    };\n};\n\n/**\n * Initialize the searching functionality so we can call it when required.\n *\n * @return {function(Object, Number, Object, Object, Object, Promise, Number, String): void}\n */\nconst searchFunctionalityCurry = () => {\n    resetGlobals();\n    return (filters, currentPage, pageData, actions, root, promises, limit, inputValue) => {\n        const searchingPromise = getSearchMyCourses(\n            filters,\n            limit,\n            inputValue\n        ).then(coursesData => {\n            pageBuilder(coursesData, currentPage, pageData, actions);\n            return renderCourses(root, loadedPages[currentPage]);\n        }).catch(Notification.exception);\n\n        promises.push(searchingPromise);\n    };\n};\n\n/**\n * Initialize the categoy searching functionality so we can call it when required.\n *\n * @return {function(Object): void}\n */\nconst catSearchFunctionality = () => {\n    return (dropdownContainer, dropdown, page, inputValue, categories, selectedCategories, customfields, selectedCustomfields) => {\n        const searchingPromise = getSearchCategories(\n            \"name\",\n            inputValue,\n            true,\n            categories,\n            selectedCategories,\n            customfields,\n            selectedCustomfields\n        ).then(categoriesData => {\n            // NOTE: Here it goes.\n            selectableCategories = categoriesData;\n            selectedCategories.forEach((selected) => {\n                const categoryIndex = selectableCategories.findIndex(item => item.id == selected.id);\n                if (categoryIndex !== -1) {\n                    selectableCategories.splice(categoryIndex, (categoryIndex + 1));\n                }\n            });\n            //return renderCategories(dropdownContainer, dropdown, categoriesData, page);\n            return renderCategories(dropdownContainer, dropdown, selectableCategories, selectedCategories, page);\n            //pageBuilder(categoriesData, actions);\n            //return renderCategories(root, loadedPages[currentPage]);\n        }).catch(Notification.exception);\n\n        // promises.push(searchingPromise);\n        // window.console.log(searchingPromise);\n        return searchingPromise;\n    };\n};\n\n/**\n * Initialise the courses list and cards views on page load.\n *\n * @param {object} root The root element for the courses view.\n * @param {function} promiseFunction How do we fetch the courses and what do we do with them?\n * @param {null | string} inputValue What to search for\n * @param {object} params The params\n */\nconst initializePagedContent = (root, promiseFunction, inputValue = null, params) => {// eslint-disable-line\n    const pagingLimit = parseInt(root.find(SELECTORS.courseView.region).attr('data-paging'), 10);\n    let itemsPerPage = itemsPerPageFunc(pagingLimit, root);\n\n    const config = { ...{}, ...DEFAULT_PAGED_CONTENT_CONFIG };\n    config.eventNamespace = namespace;\n\n    const pagedContentPromise = PagedContentFactory.createWithLimit(\n        itemsPerPage,\n        (pagesData, actions) => {\n            let promises = [];\n            pagesData.forEach(pageData => {\n                const currentPage = pageData.pageNumber;\n                let limit = (pageData.limit > 0) ? pageData.limit : 0;\n\n                // Reset local variables if limits have changed.\n                if (+lastLimit !== +limit) {\n                    loadedPages = [];\n                    courseOffset = 0;\n                    lastPage = 0;\n                }\n\n                if (lastPage === currentPage) {\n                    // If we are on the last page and have it's data then load it from cache.\n                    actions.allItemsLoaded(lastPage);\n                    promises.push(renderCourses(root, loadedPages[currentPage]));\n                    return;\n                }\n\n                lastLimit = limit;\n\n                // Get 2 pages worth of data as we will need it for the hidden functionality.\n                if (typeof (loadedPages[currentPage + 1]) === 'undefined') {\n                    if (typeof (loadedPages[currentPage]) === 'undefined') {\n                        limit *= 2;\n                    }\n                }\n\n                // Get the current applied filters.\n                const filters = getFilterValues(root);\n\n                // TODO: exchange with original function.\n                window.console.log(getAllFilterValues(root));\n\n                // Call the curried function that'll handle the course promise and any manipulation of it.\n                promiseFunction(filters, currentPage, pageData, actions, root, promises, limit, params);\n            });\n            return promises;\n        },\n        config\n    );\n\n    pagedContentPromise.then((html, js) => {\n        registerPagedEventHandlers(root, namespace);\n        return Templates.replaceNodeContents(root.find(SELECTORS.courseView.region), html, js);\n    }).catch(Notification.exception);\n};\n\n/**\n * Initialise the list of categories in the search dropdown.\n *\n * @param {string} dropdownContainer The dropdown container element.\n * @param {string} dropdown The dropdown element for the search results.\n * @param {function} promiseFunction How do we fetch the categories and what do we do with them?\n * @param {object} page The page object.\n * @param {null | string} inputValue What to search for\n * @param {object} categories\n * @param {object} selectedCategories\n * @param {object} customfields\n * @param {object} selectedCustomfields\n */\nconst initializeCategorySearchContent = (dropdownContainer,\n    dropdown,\n    promiseFunction,\n    page,\n    inputValue = null,\n    categories,\n    selectedCategories,\n    customfields,\n    selectedCustomfields) => {// eslint-disable-line\n    const $categories = promiseFunction(dropdownContainer,\n        dropdown,\n        page,\n        inputValue,\n        categories,\n        selectedCategories,\n        customfields,\n        selectedCustomfields);\n    window.console.log($categories);\n};\n\n\n/**\n * Listen to, and handle events for the eledia_telc_coursesearch block.\n *\n * @param {Object} root The eledia_telc_coursesearch block container element.\n * @param {HTMLElement} page The whole HTMLElement for our block.\n */\nconst registerEventListeners = (root, page) => {\n\n    CustomEvents.define(root, [\n        CustomEvents.events.activate\n    ]);\n\n    root.on(CustomEvents.events.activate, SELECTORS.ACTION_ADD_FAVOURITE, (e, data) => {\n        const favourite = $(e.target).closest(SELECTORS.ACTION_ADD_FAVOURITE);\n        const courseId = getCourseId(favourite);\n        addToFavourites(root, courseId);\n        data.originalEvent.preventDefault();\n    });\n\n    root.on(CustomEvents.events.activate, SELECTORS.ACTION_REMOVE_FAVOURITE, (e, data) => {\n        const favourite = $(e.target).closest(SELECTORS.ACTION_REMOVE_FAVOURITE);\n        const courseId = getCourseId(favourite);\n        removeFromFavourites(root, courseId);\n        data.originalEvent.preventDefault();\n    });\n\n    root.on(CustomEvents.events.activate, SELECTORS.FAVOURITE_ICON, (e, data) => {\n        data.originalEvent.preventDefault();\n    });\n\n    root.on(CustomEvents.events.activate, SELECTORS.ACTION_HIDE_COURSE, (e, data) => {\n        const target = $(e.target).closest(SELECTORS.ACTION_HIDE_COURSE);\n        const courseId = getCourseId(target);\n        hideCourse(root, courseId);\n        data.originalEvent.preventDefault();\n    });\n\n    root.on(CustomEvents.events.activate, SELECTORS.ACTION_SHOW_COURSE, (e, data) => {\n        const target = $(e.target).closest(SELECTORS.ACTION_SHOW_COURSE);\n        const courseId = getCourseId(target);\n        showCourse(root, courseId);\n        data.originalEvent.preventDefault();\n    });\n\n    // Searching functionality event handlers.\n    const input = page.querySelector(SELECTORS.region.searchInput);\n    const clearIcon = page.querySelector(SELECTORS.region.clearIcon);\n    const catinput = page.querySelector(SELECTORS.cat.input);\n    const clearCatIcon = page.querySelector(SELECTORS.cat.clearIcon);\n    const catSelectable = SELECTORS.cat.selectableItem;\n    const catSelected = SELECTORS.cat.selectedItem;\n\n    clearIcon.addEventListener('click', () => {\n        input.value = '';\n        searchTerm = '';\n        input.focus();\n        clearSearch(clearIcon, root);\n    });\n\n    clearCatIcon.addEventListener('click', () => {\n        window.console.log('CLICKED clearCatIcon');\n        catinput.value = '';\n        catinput.focus();\n        clearCatSearch(clearCatIcon);\n        initializeCategorySearchContent(\n            SELECTORS.cat.dropdownDiv,\n            SELECTORS.cat.dropdown,\n            catSearchFunctionality(),\n            page,\n            '',\n            selectableCategories,\n            selectedCategories,\n            customfields,\n            selectedCustomfields);\n    });\n\n    input.addEventListener('input', debounce(() => {\n        if (input.value === '') {\n            searchTerm = '';\n            clearSearch(clearIcon, root);\n        } else {\n            activeSearch(clearIcon);\n            searchTerm = input.value.trim();\n            initializePagedContent(root, searchFunctionalityCurry(), input.value.trim(), getParams());\n        }\n    }, 1000));\n\n    // Initialize category search dropdown on first click.\n    catinput.addEventListener('click', () => {\n        if (!catInit) {\n            initializeCategorySearchContent(\n                SELECTORS.cat.dropdownDiv,\n                SELECTORS.cat.dropdown,\n                catSearchFunctionality(),\n                page,\n                '',\n                selectableCategories,\n                selectedCategories,\n                customfields,\n                selectedCustomfields);\n            catInit = true;\n        }\n    });\n\n    catinput.addEventListener('input', debounce(() => {\n        if (catinput.value === '') {\n            clearCatSearch(clearCatIcon);\n            initializeCategorySearchContent(\n                SELECTORS.cat.dropdownDiv,\n                SELECTORS.cat.dropdown,\n                catSearchFunctionality(),\n                page,\n                '',\n                selectableCategories,\n                selectedCategories,\n                customfields,\n                selectedCustomfields);\n        } else {\n            window.console.log('catinput.value');\n            window.console.log(catinput.value);\n            activeSearch(clearCatIcon);\n            initializeCategorySearchContent(\n                SELECTORS.cat.dropdownDiv,\n                SELECTORS.cat.dropdown,\n                catSearchFunctionality(),\n                page,\n                catinput.value.trim(),\n                selectableCategories,\n                selectedCategories,\n                customfields,\n                selectedCustomfields);\n        }\n    }, 1000));\n\n    document.body.addEventListener('click', manageCategorydropdownCollapse);\n\n    document.body.addEventListener('click', (e) => {\n        if (e.target.classList.contains(catSelected) || e.target.classList.contains(catSelectable)) {\n            e.preventDefault();\n            manageCategorydropdownItems(\n                e,\n                catSelected,\n                catSelectable,\n                SELECTORS.cat.dropdownDiv,\n                SELECTORS.cat.dropdown,\n                catSearchFunctionality(),\n                page);\n            // TODO: Initialize search on *every* change.\n            initializePagedContent(root, searchFunctionalityCurry(), input.value.trim(), getParams());\n        }\n    });\n\n    document.body.addEventListener('click', (e) => {\n        const expandLink = e.target;\n        if (expandLink.classList.contains('eledia-telc-expandsummary')) {\n            e.preventDefault();\n            const summary = e.target.previousElementSibling;\n            expandLink.classList.add('d-none');\n            summary.classList.remove('summary-fadeout');\n        }\n    });\n\n    document.body.addEventListener('click', (e) => {\n        const collapseLink = e.target;\n        if (collapseLink.classList.contains('eledia-telc-collapsesummary')) {\n            e.preventDefault();\n            const summary = e.target.parentElement;\n            const expandLink = summary.nextElementSibling;\n            expandLink.classList.remove('d-none');\n            summary.classList.add('summary-fadeout');\n        }\n    });\n\n};\n\n/**\n * Reset the search icon and trigger the init for the block.\n *\n * @param {HTMLElement} clearIcon Our closing icon to manipulate.\n * @param {Object} root The eledia_telc_coursesearch block container element.\n */\nexport const clearSearch = (clearIcon, root) => {\n    clearIcon.classList.add('d-none');\n    init(root);\n};\n\n/**\n * Reset the search icon and trigger the init for the category search.\n *\n * @param {HTMLElement} clearCatIcon Our closing icon to manipulate.\n */\nexport const clearCatSearch = (clearCatIcon) => {\n    clearCatIcon.classList.add('d-none');\n    // TODO: Own init function if required.\n    // init(root);\n};\n\n/**\n * Change the searching icon to its' active state.\n *\n * @param {HTMLElement} clearIcon Our closing icon to manipulate.\n */\nconst activeSearch = (clearIcon) => {\n    clearIcon.classList.remove('d-none');\n};\n\n/**\n * Hide category dropdown if clicked outside category search.\n *\n * @param {PointerEvent} e a click.\n */\nconst manageCategorydropdownCollapse = (e) => {\n    const page = document.querySelector(SELECTORS.region.selectBlock);\n    const catDropdown = page.querySelector(SELECTORS.cat.dropdown);\n    if (!e.target.classList.contains('catprevent') && !e.target.classList.contains('fa-xmark')) {\n        catDropdown.style.display = 'none';\n    } else if (e.target.classList.contains('catprevent') && !e.target.classList.contains('fa-xmark')) {\n        catDropdown.style.display = 'block';\n    }\n\n};\n\n/**\n * TODO: complete\n * Hide category dropdown if clicked outside category search.\n *\n * @param {PointerEvent} e a click.\n * @param {string} selected\n * @param {string} selectable\n * @param {string} dropdownDiv\n * @param {string} dropdown\n * @param {object} promiseFunction\n * @param {object} page\n **/\nconst manageCategorydropdownItems = (e, selected, selectable, dropdownDiv, dropdown, promiseFunction, page) => {// eslint-disable-line\n    const template = 'block_eledia_telc_coursesearch/nav-category-dropdown';\n    const categoryId = e.target.dataset.catId;\n    if (e.target.classList.contains(selectable)) {\n        const categoryIndex = selectableCategories.findIndex(value => value.id == categoryId);\n        selectedCategories.push(selectableCategories.splice(categoryIndex, (categoryIndex + 1))[0]);\n    } else {\n        const categoryIndex = selectedCategories.findIndex(value => value.id == categoryId);\n        selectableCategories.push(selectedCategories.splice(categoryIndex, (categoryIndex + 1))[0]);\n    }\n    return Templates.renderForPromise(template, {\n        categories: selectableCategories,\n        catselections: selectedCategories,\n    }).then(({ html, js }) => {\n        const renderResult = Templates.replaceNodeContents(dropdownDiv, html, js);\n        const catDropdown = page.querySelector(dropdown);\n        catDropdown.style.display = 'block';\n        return renderResult;\n    }).catch(error => displayException(error));\n};\n\n/**\n * Intialise the courses list and cards views on page load.\n *\n * @param {object} root The root element for the courses view.\n */\nexport const init = root => {\n    // TODO: include course categories custom fields.\n    root = $(root);\n    loadedPages = [];\n    lastPage = 0;\n    courseOffset = 0;\n\n    if (!root.attr('data-init')) {\n        const page = document.querySelector(SELECTORS.region.selectBlock);\n        registerEventListeners(root, page);\n        namespace = \"block_eledia_telc_coursesearch_\" + root.attr('id') + \"_\" + Math.random();\n        root.attr('data-init', true);\n    }\n\n    initializePagedContent(root, standardFunctionalityCurry(), null, getParams());\n};\n\n/**\n * Reset the courses views to their original\n * state on first page load.courseOffset\n *\n * This is called when configuration has changed for the event lists\n * to cause them to reload their data.\n *\n * @param {Object} root The root element for the timeline view.\n */\nexport const reset = root => {\n    // TODO: Include categories and custom fields. May be included automatically.\n    if (loadedPages.length > 0) {\n        const filters = getFilterValues(root);\n        // If the display mode is changed to 'summary' but the summary display has not been loaded yet,\n        // we need to re-fetch the courses to include the course summary text.\n        if (filters.display === 'summary' && !summaryDisplayLoaded) {\n            const page = document.querySelector(SELECTORS.region.selectBlock);\n            const input = page.querySelector(SELECTORS.region.searchInput);\n            if (input.value !== '') {\n                initializePagedContent(root, searchFunctionalityCurry(), input.value.trim());\n            } else {\n                initializePagedContent(root, standardFunctionalityCurry());\n            }\n        } else {\n            loadedPages.forEach((courseList, index) => {\n                let pagedContentPage = getPagedContentContainer(root, index);\n                renderCourses(root, courseList).then((html, js) => {\n                    return Templates.replaceNodeContents(pagedContentPage, html, js);\n                }).catch(Notification.exception);\n            });\n        }\n    } else {\n        init(root);\n    }\n};\n"],"names":["TEMPLATES","GROUPINGS","NUMCOURSES_PERPAGE","loadedPages","courseOffset","lastPage","lastLimit","namespace","catInit","selectedCategories","selectableCategories","customfields","selectedCustomfields","searchTerm","summaryDisplayLoaded","getFilterValues","root","courseRegion","find","SELECTORS","courseView","region","display","attr","grouping","sort","displaycategories","customfieldname","customfieldvalue","getAllFilterValues","DEFAULT_PAGED_CONTENT_CONFIG","ignoreControlWhileLoading","controlPlacementBottom","persistentLimitKey","getParams","limit","params","criteria","key","value","categories","addsubcategories","getFavouriteIconContainer","courseId","FAVOURITE_ICON","getPagedContentContainer","index","getCourseId","getAddFavouriteMenuItem","getRemoveFavouriteMenuItem","addToFavourites","removeAction","addAction","setCourseFavouriteState","then","success","PubSub","publish","CourseEvents","favourited","removeClass","addClass","iconContainer","isFavouriteIcon","ICON_IS_FAVOURITE","Aria","unhide","notFavourteIcon","ICON_NOT_FAVOURITE","hide","showFavouriteIcon","Notification","alert","catch","exception","removeFromFavourites","unfavorited","hideFavouriteIcon","getHideCourseMenuItem","getShowCourseMenuItem","setCourseHiddenState","status","hideElement","id","pagingBar","jumpto","parseInt","reducedCourse","courses","reduce","accumulator","current","push","newElement","slice","forEach","courseList","popElement","length","pagedContentContainer","PagedContentFactory","resetLastPageNumber","pagedContentPage","renderCourses","html","js","Templates","replaceNodeContents","remove","Repository","setFavouriteCourses","result","warnings","course","isfavourite","noCoursesRender","nocoursesimg","newcourseurl","render","coursesData","filters","currentTemplate","Array","isArray","Object","values","map","showcoursecategory","registerPagedEventHandlers","event","PagedContentEvents","SET_ITEMS_PER_PAGE_LIMIT","subscribe","setLimit","itemsPerPageFunc","pagingLimit","itemsPerPage","active","totalCourseCount","filter","pagingOption","pageBuilder","currentPage","pageData","actions","activeSearch","nextPageStart","pageCourses","currentPageLength","remainingCourses","allItemsLoaded","nextoffset","resetGlobals","standardFunctionalityCurry","promises","searchParams","pagePromise","offset","classification","requiredfields","SUMMARY_REQUIRED_FIELDS","CARDLIST_REQUIRED_FIELDS","getEnrolledCoursesByTimeline","getMyCourses","searchFunctionalityCurry","inputValue","searchingPromise","searchValue","searchvalue","getSearchMyCourses","catSearchFunctionality","dropdownContainer","dropdown","page","subCategories","window","console","log","getCategories","getSearchCategories","categoriesData","selected","categoryIndex","findIndex","item","splice","selectionsData","renderForPromise","catselections","_ref","renderResult","querySelector","style","error","renderCategories","initializePagedContent","promiseFunction","config","eventNamespace","pagedContentPromise","createWithLimit","pagesData","pageNumber","initializeCategorySearchContent","$categories","registerEventListeners","CustomEvents","define","events","activate","on","ACTION_ADD_FAVOURITE","e","data","favourite","target","closest","originalEvent","preventDefault","ACTION_REMOVE_FAVOURITE","ACTION_HIDE_COURSE","hideAction","showAction","hideCourse","ACTION_SHOW_COURSE","showCourse","input","searchInput","clearIcon","catinput","cat","clearCatIcon","catSelectable","selectableItem","catSelected","selectedItem","addEventListener","focus","clearSearch","clearCatSearch","dropdownDiv","trim","document","body","manageCategorydropdownCollapse","classList","contains","manageCategorydropdownItems","expandLink","summary","previousElementSibling","add","parentElement","nextElementSibling","init","catDropdown","selectBlock","selectable","categoryId","dataset","catId","_ref2","Math","random"],"mappings":";;;;;;yqBAsCMA,wBACa,4CADbA,uBAEY,2CAFZA,0BAGe,8CAHfA,oBAIS,yBAGTC,sCAC2B,qBAS3BC,mBAAqB,CAAC,GAAI,GAAI,GAAI,GAAI,OAExCC,YAAc,GAEdC,aAAe,EAEfC,SAAW,EAEXC,UAAY,EAEZC,UAAY,KAEZC,SAAU,EAEVC,mBAAqB,GACrBC,qBAAuB,GAcvBC,aAAe,GACfC,qBAAuB,GACvBC,WAAa,GAUbC,sBAAuB,QAQrBC,gBAAkBC,aACdC,aAAeD,KAAKE,KAAKC,mBAAUC,WAAWC,cAC7C,CACHC,QAASL,aAAaM,KAAK,gBAC3BC,SAAUP,aAAaM,KAAK,iBAC5BE,KAAMR,aAAaM,KAAK,aACxBG,kBAAmBT,aAAaM,KAAK,0BAErCI,gBAAiBV,aAAaM,KAAK,wBACnCK,iBAAkBX,aAAaM,KAAK,2BAUtCM,mBAAqBb,aACjBC,aAAeD,KAAKE,KAAKC,mBAAUC,WAAWC,cAC7C,CACHC,QAASL,aAAaM,KAAK,gBAC3BC,SAAUP,aAAaM,KAAK,iBAC5BE,KAAMR,aAAaM,KAAK,aACxBG,kBAAmBT,aAAaM,KAAK,0BACrCZ,aAAcA,aACdF,mBAAoBA,qBAMtBqB,6BAA+B,CACjCC,2BAA2B,EAC3BC,wBAAwB,EACxBC,mBAAoB,yDA2HlBC,UAAY,eAACC,6DAAQ,QACjBC,OAAS,CACXC,SAAU,CACN,CACIC,IAAK,OACLC,MAAO1B,YAEX,CACIyB,IAAK,qBACLE,WAAY/B,oBAEhB,CACI6B,IAAK,uBACL3B,aAAcC,sBAElB,CACI0B,IAAK,QACLC,MAAOJ,OAEX,CACIG,IAAK,SACLC,MAAOnC,eAGfqC,kBAAkB,UAEfL,QAULM,0BAA4B,CAAC1B,KAAM2B,WAC9B3B,KAAKE,KAAKC,mBAAUyB,eAAiB,oBAAsBD,SAAW,MAU3EE,yBAA2B,CAAC7B,KAAM8B,QAC7B9B,KAAKE,KAAK,iDAAmD4B,MAAQ,MAS1EC,YAAc/B,MACTA,KAAKO,KAAK,kBA8CfyB,wBAA0B,CAAChC,KAAM2B,WAC5B3B,KAAKE,KAAK,iDAAmDyB,SAAW,MAU7EM,2BAA6B,CAACjC,KAAM2B,WAC/B3B,KAAKE,KAAK,oDAAsDyB,SAAW,MAShFO,gBAAkB,CAAClC,KAAM2B,kBACrBQ,aAAeF,2BAA2BjC,KAAM2B,UAChDS,UAAYJ,wBAAwBhC,KAAM2B,UAEhDU,wBAAwBV,UAAU,GAAMW,MAAKC,UACrCA,SACAC,OAAOC,QAAQC,aAAaC,WAAYhB,UACxCQ,aAAaS,YAAY,UACzBR,UAAUS,SAAS,UAhDL,EAAC7C,KAAM2B,kBACvBmB,cAAgBpB,0BAA0B1B,KAAM2B,UAEhDoB,gBAAkBD,cAAc5C,KAAKC,mBAAU6C,mBACrDD,gBAAgBH,YAAY,UAC5BK,KAAKC,OAAOH,uBAENI,gBAAkBL,cAAc5C,KAAKC,mBAAUiD,oBACrDD,gBAAgBN,SAAS,UACzBI,KAAKI,KAAKF,kBAwCFG,CAAkBtD,KAAM2B,WAExB4B,aAAaC,MAAM,yBAA0B,uCAGlDC,MAAMF,aAAaG,YASpBC,qBAAuB,CAAC3D,KAAM2B,kBAC1BQ,aAAeF,2BAA2BjC,KAAM2B,UAChDS,UAAYJ,wBAAwBhC,KAAM2B,UAEhDU,wBAAwBV,UAAU,GAAOW,MAAKC,UACtCA,SACAC,OAAOC,QAAQC,aAAakB,YAAajC,UACzCQ,aAAaU,SAAS,UACtBT,UAAUQ,YAAY,UAzFR,EAAC5C,KAAM2B,kBACvBmB,cAAgBpB,0BAA0B1B,KAAM2B,UAEhDoB,gBAAkBD,cAAc5C,KAAKC,mBAAU6C,mBACrDD,gBAAgBF,SAAS,UACzBI,KAAKI,KAAKN,uBAEJI,gBAAkBL,cAAc5C,KAAKC,mBAAUiD,oBACrDD,gBAAgBP,YAAY,UAC5BK,KAAKC,OAAOC,kBAiFJU,CAAkB7D,KAAM2B,WAExB4B,aAAaC,MAAM,yBAA0B,uCAGlDC,MAAMF,aAAaG,YAUpBI,sBAAwB,CAAC9D,KAAM2B,WAC1B3B,KAAKE,KAAK,+CAAiDyB,SAAW,MAU3EoC,sBAAwB,CAAC/D,KAAM2B,WAC1B3B,KAAKE,KAAK,+CAAiDyB,SAAW,MAwD3EqC,qBAAuB,CAACrC,SAAUsC,WAGrB,IAAXA,SACAA,OAAS,OAGN,yFAAkEtC,UAAYsC,QAChFR,MAAMF,aAAaG,YAStBQ,YAAc,CAAClE,KAAMmE,YACjBC,UAAYpE,KAAKE,KAAK,8BACtBmE,OAASC,SAASF,UAAU7D,KAAK,gCAInCgE,cADepF,YAAYkF,QACAG,QAAQC,QAAO,CAACC,YAAaC,YACnDR,KAAQQ,QAAQR,IACjBO,YAAYE,KAAKD,SAEdD,cACR,YAGsC,IAA7BvF,YAAYkF,OAAS,GAAqB,OAC5CQ,WAAa1F,YAAYkF,OAAS,GAAGG,QAAQM,MAAM,EAAG,GAG5D3F,YAAY4F,SAAQ,CAACC,WAAYlD,YACzBA,MAAQuC,OAAQ,KACZY,WAAa,QACuB,IAA5B9F,YAAY2C,MAAQ,KAC5BmD,WAAa9F,YAAY2C,MAAQ,GAAG0C,QAAQM,MAAM,EAAG,IAEzD3F,YAAY2C,OAAO0C,QAAU,IAAIrF,YAAY2C,OAAO0C,QAAQM,MAAM,MAAOG,gBAIjFV,cAAgB,IAAIA,iBAAkBM,eAItCxF,WAAagF,OAAS,GAAgD,IAA3ClF,YAAYkF,OAAS,GAAGG,QAAQU,OAAc,OACnEC,sBAAwBnF,KAAKE,KAAK,2CACxCkF,oBAAoBC,qBAAoB,mBAAEF,uBAAuB5E,KAAK,MAAO8D,QAGjFlF,YAAYkF,QAAQG,QAAUD,cAG9BnF,qBAGMkG,iBAAmBzD,yBAAyB7B,KAAMqE,QACxDkB,cAAcvF,KAAMb,YAAYkF,SAAS/B,MAAK,CAACkD,KAAMC,KAC1CC,UAAUC,oBAAoBL,iBAAkBE,KAAMC,MAC9DhC,MAAMF,aAAaG,WAGtBvE,YAAY4F,SAAQ,CAACC,WAAYlD,YACzBA,MAAQuC,OAAQ,CACHxC,yBAAyB7B,KAAM8B,OACvC8D,cAYXvD,wBAA0B,CAACV,SAAUsC,SAEhC4B,WAAWC,oBAAoB,CAClCtB,QAAS,CACL,IACU7C,mBACOsC,WAGtB3B,MAAKyD,QAC2B,IAA3BA,OAAOC,SAASd,SAChB/F,YAAY4F,SAAQC,aAChBA,WAAWR,QAAQO,SAAQ,CAACkB,OAAQnE,SAC5BmE,OAAO9B,IAAMxC,WACbqD,WAAWR,QAAQ1C,OAAOoE,YAAcjC,eAI7C,KAIZR,MAAMF,aAAaG,WASpByC,gBAAkBnG,aACdoG,aAAepG,KAAKE,KAAKC,mBAAUC,WAAWC,QAAQE,KAAK,qBAC3D8F,aAAerG,KAAKE,KAAKC,mBAAUC,WAAWC,QAAQE,KAAK,4BAC1DmF,UAAUY,OAAOtH,oBAAqB,CACzCoH,aAAcA,aACdC,aAAcA,gBAWhBd,cAAgB,CAACvF,KAAMuG,qBAEnBC,QAAUzG,gBAAgBC,UAE5ByG,gBAAkB,UAElBA,gBADoB,SAApBD,QAAQlG,QACUtB,wBACS,SAApBwH,QAAQlG,QACGtB,uBAEAA,0BAGjBuH,cAI0C,IAAvCG,MAAMC,QAAQJ,YAAY/B,WAC1B+B,YAAY/B,QAAUoC,OAAOC,OAAON,YAAY/B,UAGpD+B,YAAY/B,QAAU+B,YAAY/B,QAAQsC,KAAIb,SAC1CA,OAAOc,mBAAmD,OAA9BP,QAAQ9F,kBAC7BuF,UAEPM,YAAY/B,QAAQU,OACbQ,UAAUY,OAAOG,gBAAiB,CACrCjC,QAAS+B,YAAY/B,UAGlB2B,gBAAgBnG,OAhBpBmG,gBAAgBnG,OA8EzBgH,2BAA6B,CAAChH,KAAMT,mBAChC0H,MAAQ1H,UAAY2H,mBAAmBC,yBAC7C3E,OAAO4E,UAAUH,MAdJjH,CAAAA,MAENmB,OAASnB,KAAKE,KAAKC,mBAAUC,WAAWC,QAAQE,KAAK,cAAeY,OAYnDkG,CAASrH,QAU/BsH,iBAAmB,CAACC,YAAavH,YAC/BwH,aAAetI,mBAAmB4H,KAAIvF,YAClCkG,QAAS,SACTlG,QAAUgG,cACVE,QAAS,GAGN,CACHlG,MAAOA,MACPkG,OAAQA,iBAKVC,iBAAmBpD,SAAStE,KAAKE,KAAKC,mBAAUC,WAAWC,QAAQE,KAAK,yBAA0B,WACjGiH,aAAaG,QAAOC,gBACI,IAAvBA,aAAarG,OAAemG,iBAAmB,MAK5CE,aAAarG,MAAQmG,oBAa9BG,YAAc,SAACtB,YAAauB,YAAaC,SAAUC,aAASC,oEAAe,KAGzEzD,QAAU+B,YAAY/B,QAAU+B,YAAY/B,QAAU+B,YACtD2B,cAAgB,EAChBC,YAAc,WAGwB,IAA9BhJ,YAAY2I,aAA+B,CACnDK,YAAchJ,YAAY2I,aAAatD,cACjC4D,kBAAoBD,YAAYjD,OAClCkD,kBAAoBL,SAAS5G,QAC7B+G,cAAgBH,SAAS5G,MAAQiH,kBACjCD,YAAc,IAAKhJ,YAAY2I,aAAatD,WAAYA,QAAQM,MAAM,EAAGoD,sBAI7EA,cAAgBH,SAAS5G,QAAS,EAClCgH,YAAeJ,SAAS5G,MAAQ,EAAKqD,QAAQM,MAAM,EAAGiD,SAAS5G,OAASqD,QAI5ErF,YAAY2I,aAAe,CACvBtD,QAAS2D,mBAIPE,kBAAqC,IAAlBH,cAA0B1D,QAAQM,MAAMoD,cAAe1D,QAAQU,QAAU,GAC9FmD,iBAAiBnD,SACjB/F,YAAY2I,YAAc,GAAK,CAC3BtD,QAAS6D,mBAKblJ,YAAY2I,aAAatD,QAAQU,OAAS6C,SAAS5G,QAAUkH,iBAAiBnD,QAC9E7F,SAAWyI,YACU,OAAjBG,cACAD,QAAQM,eAAeR,mBAEsB,IAAlC3I,YAAY2I,YAAc,IACtC3I,YAAY2I,YAAc,GAAGtD,QAAQU,OAAS6C,SAAS5G,QAC1D9B,SAAWyI,YAAc,GAG7B1I,aAAemH,YAAYgC,YAMzBC,aAAe,KACjBpJ,aAAe,EACfD,YAAc,GACdE,SAAW,EACXC,UAAY,GAQVmJ,2BAA6B,KAC/BD,eACO,CAAChC,QAASsB,YAAaC,SAAUC,QAAShI,KAAM0I,SAAUvH,MAAOwH,sBAC9DC,YA5qBO,EAACpC,QAASrF,MAAOwH,sBAE5BvH,OAAS,CACXyH,OAAQzJ,aACR+B,MAAOA,MACP2H,eAAgBtC,QAAQhG,SACxBC,KAAM+F,QAAQ/F,KACdE,gBAAiB6F,QAAQ7F,gBACzBC,iBAAkB4F,QAAQ5F,wBAEN,YAApB4F,QAAQlG,SACRc,OAAO2H,eAAiBlD,WAAWmD,wBACnClJ,sBAAuB,GAEvBsB,OAAO2H,eAAiBlD,WAAWoD,yBAGhCpD,WAAWqD,6BAA6BP,eA2pBvBQ,CAChB3C,QACArF,MACAwH,cACFrG,MAAKiE,cACHsB,YAAYtB,YAAauB,YAAaC,SAAUC,SACzCzC,cAAcvF,KAAMb,YAAY2I,iBACxCrE,MAAMF,aAAaG,WAEtBgF,SAAS9D,KAAKgE,eAShBQ,yBAA2B,KAC7BZ,eACO,CAAChC,QAASsB,YAAaC,SAAUC,QAAShI,KAAM0I,SAAUvH,MAAOkI,oBAC9DC,iBArqBa,EAAC9C,QAASrF,MAAOoI,qBAClCnI,OAAS,CACXyH,OAAQzJ,aACR+B,MAAOA,MACP2H,eAAgB,SAChBrI,KAAM+F,QAAQ/F,KACdE,gBAAiB6F,QAAQ7F,gBACzBC,iBAAkB4F,QAAQ5F,iBAC1B4I,YAAaD,mBAEO,YAApB/C,QAAQlG,SACRc,OAAO2H,eAAiBlD,WAAWmD,wBACnClJ,sBAAuB,IAEvBsB,OAAO2H,eAAiBlD,WAAWoD,yBACnCnJ,sBAAuB,GAGpB+F,WAAWqD,6BAA6BK,cAmpBlBE,CACrBjD,QACArF,MACAkI,YACF/G,MAAKiE,cACHsB,YAAYtB,YAAauB,YAAaC,SAAUC,SACzCzC,cAAcvF,KAAMb,YAAY2I,iBACxCrE,MAAMF,aAAaG,WAEtBgF,SAAS9D,KAAK0E,oBAShBI,uBAAyB,IACpB,CAACC,kBAAmBC,SAAUC,KAAMR,WAAY7H,WAAY/B,mBAAoBE,aAAcC,8BAC3F0J,iBAxpBc,EAAChI,IACzBiI,YACAO,cACAtI,WACA/B,mBACAE,aACAC,wBACAmK,OAAOC,QAAQC,IAAI3I,KACnByI,OAAOC,QAAQC,IAAIV,aACnBQ,OAAOC,QAAQC,IAAIxK,0BAGb2B,OAAS,CAEXC,SAAU,CACN,CACIC,IAAKA,IACLC,MAAOgI,aAEX,CACIjI,IAAK,aACL3B,aAXC,IAaL,CACI2B,IAAK,qBACL3B,aAdZF,mBAAqB,IAgBb,CACI6B,IAAK,eACL3B,aAAcA,cAElB,CACI2B,IAAK,uBACL3B,aAAcC,uBAMtB6B,iBAAkBqI,sBAEfjE,WAAWqE,cAAc9I,SA+mBH+I,CACrB,OACAd,YACA,EACA7H,EACA/B,mBACAE,aACAC,sBACF0C,MAAK8H,iBAEH1K,qBAAuB0K,eACvB3K,mBAAmBsF,SAASsF,iBAClBC,cAAgB5K,qBAAqB6K,WAAUC,MAAQA,KAAKrG,IAAMkG,SAASlG,MAC1D,IAAnBmG,eACA5K,qBAAqB+K,OAAOH,cAAgBA,cAAgB,MAtNvD,EAACX,kBAAmBC,SAAUQ,eAAgBM,eAAgBb,QAcnFE,OAAOC,QAAQC,IAAI,yBACZvE,UAAUiF,iBAXA,uDAW2B,CACxCnJ,WAAY4I,eACZQ,cAAeF,iBAChBpI,MAAKuI,WAACrF,KAAEA,KAAFC,GAAQA,SACbsE,OAAOC,QAAQC,IAAI,uBACnBF,OAAOC,QAAQC,IAAIzE,MACnBuE,OAAOC,QAAQC,IAAIxE,UACbqF,aAAepF,UAAUC,oBAAoBgE,kBAAmBnE,KAAMC,WACxDoE,KAAKkB,cAAcnB,UAC3BoB,MAAM1K,QAAU,QACrBwK,gBACRrH,OAAMwH,QAAS,0BAAiBA,UAgMpBC,CAAiBvB,kBAAmBC,SAAUlK,qBAAsBD,mBAAoBoK,SAGhGpG,MAAMF,aAAaG,kBAIf4F,kBAYT6B,uBAAyB,SAACnL,KAAMoL,qBAAoChK,oDAChEmG,YAAcjD,SAAStE,KAAKE,KAAKC,mBAAUC,WAAWC,QAAQE,KAAK,eAAgB,QACrFiH,aAAeF,iBAAiBC,YAAavH,YAE3CqL,OAAS,IAAYvK,8BAC3BuK,OAAOC,eAAiB/L,gBAElBgM,oBAAsBnG,oBAAoBoG,gBAC5ChE,cACA,CAACiE,UAAWzD,eACJU,SAAW,UACf+C,UAAU1G,SAAQgD,iBACRD,YAAcC,SAAS2D,eACzBvK,MAAS4G,SAAS5G,MAAQ,EAAK4G,SAAS5G,MAAQ,MAG/C7B,YAAe6B,QAChBhC,YAAc,GACdC,aAAe,EACfC,SAAW,GAGXA,WAAayI,mBAEbE,QAAQM,eAAejJ,eACvBqJ,SAAS9D,KAAKW,cAAcvF,KAAMb,YAAY2I,eAIlDxI,UAAY6B,WAGkC,IAAlChC,YAAY2I,YAAc,SACQ,IAA9B3I,YAAY2I,eACpB3G,OAAS,SAKXqF,QAAUzG,gBAAgBC,MAGhC+J,OAAOC,QAAQC,IAAIpJ,mBAAmBb,OAGtCoL,gBAAgB5E,QAASsB,YAAaC,SAAUC,QAAShI,KAAM0I,SAAUvH,MAAOC,WAE7EsH,WAEX2C,QAGJE,oBAAoBjJ,MAAK,CAACkD,KAAMC,MAC5BuB,2BAA2BhH,KAAMT,WAC1BmG,UAAUC,oBAAoB3F,KAAKE,KAAKC,mBAAUC,WAAWC,QAASmF,KAAMC,OACpFhC,MAAMF,aAAaG,YAgBpBiI,gCAAkC,SAAChC,kBACrCC,SACAwB,gBACAvB,UACAR,kEAAa,KACb7H,kDACA/B,0DACAE,oDACAC,kEACMgM,YAAcR,gBAAgBzB,kBAChCC,SACAC,KACAR,WACA7H,WACA/B,mBACAE,aACAC,sBACJmK,OAAOC,QAAQC,IAAI2B,cAUjBC,uBAAyB,CAAC7L,KAAM6J,QAElCiC,aAAaC,OAAO/L,KAAM,CACtB8L,aAAaE,OAAOC,WAGxBjM,KAAKkM,GAAGJ,aAAaE,OAAOC,SAAU9L,mBAAUgM,sBAAsB,CAACC,EAAGC,cAChEC,WAAY,mBAAEF,EAAEG,QAAQC,QAAQrM,mBAAUgM,sBAC1CxK,SAAWI,YAAYuK,WAC7BpK,gBAAgBlC,KAAM2B,UACtB0K,KAAKI,cAAcC,oBAGvB1M,KAAKkM,GAAGJ,aAAaE,OAAOC,SAAU9L,mBAAUwM,yBAAyB,CAACP,EAAGC,cACnEC,WAAY,mBAAEF,EAAEG,QAAQC,QAAQrM,mBAAUwM,yBAC1ChL,SAAWI,YAAYuK,WAC7B3I,qBAAqB3D,KAAM2B,UAC3B0K,KAAKI,cAAcC,oBAGvB1M,KAAKkM,GAAGJ,aAAaE,OAAOC,SAAU9L,mBAAUyB,gBAAgB,CAACwK,EAAGC,QAChEA,KAAKI,cAAcC,oBAGvB1M,KAAKkM,GAAGJ,aAAaE,OAAOC,SAAU9L,mBAAUyM,oBAAoB,CAACR,EAAGC,cAC9DE,QAAS,mBAAEH,EAAEG,QAAQC,QAAQrM,mBAAUyM,oBACvCjL,SAAWI,YAAYwK,QArkBlB,EAACvM,KAAM2B,kBAChBkL,WAAa/I,sBAAsB9D,KAAM2B,UACzCmL,WAAa/I,sBAAsB/D,KAAM2B,UACzC6E,QAAUzG,gBAAgBC,MAEhCgE,qBAAqBrC,UAAU,GAI3B6E,QAAQhG,WAAavB,uCACrBiF,YAAYlE,KAAM2B,UAGtBkL,WAAWhK,SAAS,UACpBiK,WAAWlK,YAAY,WAwjBnBmK,CAAW/M,KAAM2B,UACjB0K,KAAKI,cAAcC,oBAGvB1M,KAAKkM,GAAGJ,aAAaE,OAAOC,SAAU9L,mBAAU6M,oBAAoB,CAACZ,EAAGC,cAC9DE,QAAS,mBAAEH,EAAEG,QAAQC,QAAQrM,mBAAU6M,oBACvCrL,SAAWI,YAAYwK,QArjBlB,EAACvM,KAAM2B,kBAChBkL,WAAa/I,sBAAsB9D,KAAM2B,UACzCmL,WAAa/I,sBAAsB/D,KAAM2B,UACzC6E,QAAUzG,gBAAgBC,MAEhCgE,qBAAqBrC,SAAU,MAI3B6E,QAAQhG,WAAavB,uCACrBiF,YAAYlE,KAAM2B,UAGtBkL,WAAWjK,YAAY,UACvBkK,WAAWjK,SAAS,WAwiBhBoK,CAAWjN,KAAM2B,UACjB0K,KAAKI,cAAcC,0BAIjBQ,MAAQrD,KAAKkB,cAAc5K,mBAAUE,OAAO8M,aAC5CC,UAAYvD,KAAKkB,cAAc5K,mBAAUE,OAAO+M,WAChDC,SAAWxD,KAAKkB,cAAc5K,mBAAUmN,IAAIJ,OAC5CK,aAAe1D,KAAKkB,cAAc5K,mBAAUmN,IAAIF,WAChDI,cAAgBrN,mBAAUmN,IAAIG,eAC9BC,YAAcvN,mBAAUmN,IAAIK,aAElCP,UAAUQ,iBAAiB,SAAS,KAChCV,MAAM3L,MAAQ,GACd1B,WAAa,GACbqN,MAAMW,QACNC,YAAYV,UAAWpN,SAG3BuN,aAAaK,iBAAiB,SAAS,KACnC7D,OAAOC,QAAQC,IAAI,wBACnBoD,SAAS9L,MAAQ,GACjB8L,SAASQ,QACTE,eAAeR,cACf5B,gCACIxL,mBAAUmN,IAAIU,YACd7N,mBAAUmN,IAAI1D,SACdF,yBACAG,KACA,GACAnK,qBACAD,mBACAE,aACAC,yBAGRsN,MAAMU,iBAAiB,SAAS,oBAAS,KACjB,KAAhBV,MAAM3L,OACN1B,WAAa,GACbiO,YAAYV,UAAWpN,QAEvBiI,aAAamF,WACbvN,WAAaqN,MAAM3L,MAAM0M,OACzB9C,uBAAuBnL,KAAMoJ,2BAA4B8D,MAAM3L,MAAM0M,OAAQ/M,gBAElF,MAGHmM,SAASO,iBAAiB,SAAS,KAC1BpO,UACDmM,gCACIxL,mBAAUmN,IAAIU,YACd7N,mBAAUmN,IAAI1D,SACdF,yBACAG,KACA,GACAnK,qBACAD,mBACAE,aACAC,sBACJJ,SAAU,MAIlB6N,SAASO,iBAAiB,SAAS,oBAAS,KACjB,KAAnBP,SAAS9L,OACTwM,eAAeR,cACf5B,gCACIxL,mBAAUmN,IAAIU,YACd7N,mBAAUmN,IAAI1D,SACdF,yBACAG,KACA,GACAnK,qBACAD,mBACAE,aACAC,wBAEJmK,OAAOC,QAAQC,IAAI,kBACnBF,OAAOC,QAAQC,IAAIoD,SAAS9L,OAC5B0G,aAAasF,cACb5B,gCACIxL,mBAAUmN,IAAIU,YACd7N,mBAAUmN,IAAI1D,SACdF,yBACAG,KACAwD,SAAS9L,MAAM0M,OACfvO,qBACAD,mBACAE,aACAC,yBAET,MAEHsO,SAASC,KAAKP,iBAAiB,QAASQ,gCAExCF,SAASC,KAAKP,iBAAiB,SAAUxB,KACjCA,EAAEG,OAAO8B,UAAUC,SAASZ,cAAgBtB,EAAEG,OAAO8B,UAAUC,SAASd,kBACxEpB,EAAEM,iBACF6B,4BACInC,EACAsB,YACAF,cACArN,mBAAUmN,IAAIU,YACd7N,mBAAUmN,IAAI1D,SACdF,yBACAG,MAEJsB,uBAAuBnL,KAAMoJ,2BAA4B8D,MAAM3L,MAAM0M,OAAQ/M,iBAIrFgN,SAASC,KAAKP,iBAAiB,SAAUxB,UAC/BoC,WAAapC,EAAEG,UACjBiC,WAAWH,UAAUC,SAAS,6BAA8B,CAC5DlC,EAAEM,uBACI+B,QAAUrC,EAAEG,OAAOmC,uBACzBF,WAAWH,UAAUM,IAAI,UACzBF,QAAQJ,UAAUzI,OAAO,uBAIjCsI,SAASC,KAAKP,iBAAiB,SAAUxB,OAChBA,EAAEG,OACN8B,UAAUC,SAAS,+BAAgC,CAChElC,EAAEM,uBACI+B,QAAUrC,EAAEG,OAAOqC,cACNH,QAAQI,mBAChBR,UAAUzI,OAAO,UAC5B6I,QAAQJ,UAAUM,IAAI,wBAYrBb,YAAc,CAACV,UAAWpN,QACnCoN,UAAUiB,UAAUM,IAAI,UACxBG,KAAK9O,8CAQI+N,eAAkBR,eAC3BA,aAAac,UAAUM,IAAI,wDAUzB1G,aAAgBmF,YAClBA,UAAUiB,UAAUzI,OAAO,WAQzBwI,+BAAkChC,UAE9B2C,YADOb,SAASnD,cAAc5K,mBAAUE,OAAO2O,aAC5BjE,cAAc5K,mBAAUmN,IAAI1D,UAChDwC,EAAEG,OAAO8B,UAAUC,SAAS,eAAkBlC,EAAEG,OAAO8B,UAAUC,SAAS,YAEpElC,EAAEG,OAAO8B,UAAUC,SAAS,gBAAkBlC,EAAEG,OAAO8B,UAAUC,SAAS,cACjFS,YAAY/D,MAAM1K,QAAU,SAF5ByO,YAAY/D,MAAM1K,QAAU,QAmB9BiO,4BAA8B,CAACnC,EAAG/B,SAAU4E,WAAYjB,YAAapE,SAAUwB,gBAAiBvB,cAE5FqF,WAAa9C,EAAEG,OAAO4C,QAAQC,SAChChD,EAAEG,OAAO8B,UAAUC,SAASW,YAAa,OACnC3E,cAAgB5K,qBAAqB6K,WAAUhJ,OAASA,MAAM4C,IAAM+K,aAC1EzP,mBAAmBmF,KAAKlF,qBAAqB+K,OAAOH,cAAgBA,cAAgB,GAAI,QACrF,OACGA,cAAgB7K,mBAAmB8K,WAAUhJ,OAASA,MAAM4C,IAAM+K,aACxExP,qBAAqBkF,KAAKnF,mBAAmBgL,OAAOH,cAAgBA,cAAgB,GAAI,WAErF5E,UAAUiF,iBATA,uDAS2B,CACxCnJ,WAAY9B,qBACZkL,cAAenL,qBAChB6C,MAAK+M,YAAC7J,KAAEA,KAAFC,GAAQA,gBACPqF,aAAepF,UAAUC,oBAAoBqI,YAAaxI,KAAMC,WAClDoE,KAAKkB,cAAcnB,UAC3BoB,MAAM1K,QAAU,QACrBwK,gBACRrH,OAAMwH,QAAS,0BAAiBA,UAQ1B6D,KAAO9O,UAEhBA,MAAO,mBAAEA,MACTb,YAAc,GACdE,SAAW,EACXD,aAAe,GAEVY,KAAKO,KAAK,aAAc,OACnBsJ,KAAOqE,SAASnD,cAAc5K,mBAAUE,OAAO2O,aACrDnD,uBAAuB7L,KAAM6J,MAC7BtK,UAAY,kCAAoCS,KAAKO,KAAK,MAAQ,IAAM+O,KAAKC,SAC7EvP,KAAKO,KAAK,aAAa,GAG3B4K,uBAAuBnL,KAAMyI,6BAA8B,KAAMvH,gDAYhDlB,UAEbb,YAAY+F,OAAS,EAAG,IAIA,YAHRnF,gBAAgBC,MAGpBM,SAA0BR,qBASlCX,YAAY4F,SAAQ,CAACC,WAAYlD,aACzBwD,iBAAmBzD,yBAAyB7B,KAAM8B,OACtDyD,cAAcvF,KAAMgF,YAAY1C,MAAK,CAACkD,KAAMC,KACjCC,UAAUC,oBAAoBL,iBAAkBE,KAAMC,MAC9DhC,MAAMF,aAAaG,kBAb8B,OAElDwJ,MADOgB,SAASnD,cAAc5K,mBAAUE,OAAO2O,aAClCjE,cAAc5K,mBAAUE,OAAO8M,aAC9B,KAAhBD,MAAM3L,MACN4J,uBAAuBnL,KAAMoJ,2BAA4B8D,MAAM3L,MAAM0M,QAErE9C,uBAAuBnL,KAAMyI,oCAWrCqG,KAAK9O"}